{% extends 'base.html' %}

{% block title %}Registro - Loja{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">üõí Registro de Pontua√ß√£o - Loja</h2>

    <form method="POST">
  <div class="mb-3">
    <label for="data" class="form-label">Data:</label>
    <input type="text" class="form-control" name="data" id="data" required placeholder="dd/mm/aaaa" autocomplete="off">
  </div>

  <div class="mb-3">
  <label for="datas" class="form-label">M√∫ltiplas datas (opcional):</label>
  <input type="text" class="form-control" name="datas" id="datas"
         placeholder="dd/mm/aaaa, dd/mm/aaaa, dd/mm/aaaa" autocomplete="off">
  <small class="text-muted">Se preencher aqui, o campo ‚ÄúData‚Äù acima ser√° ignorado.</small>
</div>



        <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" name="criterios" value="A" id="A">
            <label class="form-check-label" for="A"><span class="text-warning">Ger. ADM</span><br>Organiza√ß√£o da loja (+1)</label>
        </div>
        <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" name="criterios" value="B" id="B">
            <label class="form-check-label" for="B"><span style="color: #8e44ad;">RH</span><br>Pontualidade (+1)</label>
        </div>
        <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" name="criterios" value="C" id="C">
            <label class="form-check-label" for="C"><span style="color: red;">Financeiro</span><br>Fechamento do caixa (+1)</label>
        </div>
        <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" name="criterios" value="D" id="D">
            <label class="form-check-label" for="D"><span style="color: #8e44ad;">RH</span><br>N√£o postar em rede social (-1)</label>
        </div>
        <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" name="criterios" value="E" id="E">
            <label class="form-check-label" for="E"><span class="text-warning">Ger. ADM</span><br>Validade/Avaria (-2)</label>
        </div>

        <hr>

        <h5>Extras:</h5>
        <div class="form-check mb-1">
            <input class="form-check-input" type="checkbox" name="extras" value="meta" id="meta">
            <label class="form-check-label" for="meta">üìà Meta de faturamento (+2)</label>
        </div>

        <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" name="extras" value="equipe90" id="equipe90">
            <label class="form-check-label" for="equipe90">ü§ù Equipe chegou a 90% de pontua√ß√£o (+1)</label>
        </div>

        <div class="mb-3 mt-3">
            <label for="observacao" class="form-label">Observa√ß√£o:</label>
            <textarea class="form-control" name="observacao" rows="2"></textarea>
        </div>

        <button type="submit" class="btn btn-success">Salvar</button>
    </form>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>

<script>
  // Calend√°rio dd/mm/aaaa para 1 data
  flatpickr("#data", {
    dateFormat: "d/m/Y",
    locale: flatpickr.l10ns.pt,
    disableMobile: true
  });

  // Calend√°rio dd/mm/aaaa com m√∫ltipla sele√ß√£o
  flatpickr("#datas", {
    mode: "multiple",
    dateFormat: "d/m/Y",
    conjunction: ", ",
    locale: flatpickr.l10ns.pt,
    disableMobile: true,
    onChange: toggleRequired
  });

  // Se "M√∫ltiplas datas" tiver conte√∫do, remove o "required" de "Data"
  const inputData  = document.getElementById('data');
  const inputDatas = document.getElementById('datas');
  function toggleRequired() {
    if ((inputDatas.value || "").trim()) {
      inputData.removeAttribute("required");
    } else {
      inputData.setAttribute("required", "required");
    }
  }
  inputDatas && inputDatas.addEventListener("input", toggleRequired);
  toggleRequired();
</script>

<script>
  // Se "M√∫ltiplas datas" tiver conte√∫do, remove o "required" do campo Data
  const inputData = document.getElementById('data');
  const textareaDatas = document.getElementById('datas');

  function toggleRequired() {
    if (textareaDatas.value.trim()) {
      inputData.removeAttribute('required');
    } else {
      inputData.setAttribute('required', 'required');
    }
  }
  textareaDatas.addEventListener('input', toggleRequired);
  toggleRequired();
</script>
</div>
{% endblock %}
